// ==========================================
// â˜… è¨­å®šé …ç›®ï¼ˆã“ã“ã ã‘æ›¸ãæ›ãˆã¦ãã ã•ã„ï¼‰
// ==========================================


// ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåï¼ˆIDè¿½åŠ æ™‚ã«è¨­å®šã—ãŸåå‰ã¨ä¸€è‡´ã•ã›ã‚‹ï¼‰
const LIB = TaskManager;


// ==========================================
// 1. èªè¨¼ãƒã‚§ãƒƒã‚¯
// ==========================================
// èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã¯ã™ã¹ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå´ã«ç§»å‹•ã—ã¾ã—ãŸ
// ã“ã‚Œã«ã‚ˆã‚Šã€é…å¸ƒã‚³ãƒ¼ãƒ‰ã‚’æ”¹ç«„ã—ã¦ã‚‚èªè¨¼ã‚’å›é¿ã§ãã¾ã›ã‚“




// ==========================================
// 2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨ãƒˆãƒªã‚¬ãƒ¼ï¼ˆãƒã‚¹ã‚¿ãƒ¼ã¨å®Œå…¨ä¸€è‡´ï¼‰
// ==========================================
function onOpen() {
const ui = SpreadsheetApp.getUi();
ui.createMenu('ğŸ“… ã‚¿ã‚¹ã‚¯é€£æº')
  .addItem('è¨­å®š: è‡ªå‹•åŒ–ãƒˆãƒªã‚¬ãƒ¼ã‚’ã‚»ãƒƒãƒˆ (æ›´æ–°æ™‚ã‚‚å®Ÿè¡Œ)', 'setupTriggers')
  .addItem('ğŸ”§ è¨­å®šãƒã‚§ãƒƒã‚¯ (åˆæœŸè¨ºæ–­)', 'checkConfiguration') // â˜…è¿½åŠ 
  .addSeparator()
  .addItem('æ‰‹å‹•: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚·ãƒ¼ãƒˆä½œæˆ', 'createProjectSheets')
  .addItem('æ‰‹å‹•: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åŒæœŸ (ã‚¿ã‚¹ã‚¯å…¥åŠ›)', 'syncTasksToCalendar')
  .addItem('æ‰‹å‹•: ã€çµ±åˆã€‘åŒæœŸãƒ»è»¢é€ãƒ»ä¸¦ã³æ›¿ãˆ (ã‚¿ã‚¹ã‚¯å…¥åŠ›)', 'executeTasksAction')
  .addItem('æ‰‹å‹•: ã‚¿ã‚¹ã‚¯ä¸€è¦§æ›´æ–° (çµ±åˆç‰ˆ)', 'updateDashboardWithCalendarSync')
  .addSeparator()
  .addItem('ğŸ”§ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®å¾© (ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å†è¨­ç½®)', 'repairCheckboxes') // â˜…è¿½åŠ 
  .addToUi();
}


// ç·¨é›†æ™‚ã®ãƒˆãƒªã‚¬ãƒ¼
function onEditTrigger(e) {
LIB.onEditTrigger(e);
}


// ==========================================
// 3. æ©Ÿèƒ½å‘¼ã³å‡ºã—ï¼ˆãƒ©ãƒƒãƒ‘ãƒ¼é–¢æ•°ï¼‰
// ==========================================


// ãƒˆãƒªã‚¬ãƒ¼è¨­å®š
function setupTriggers() {
LIB.setupTriggers();
}


// è¨­å®šãƒã‚§ãƒƒã‚¯
function checkConfiguration() {
LIB.checkConfiguration();
}


// ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®å¾©
function repairCheckboxes() {
LIB.repairCheckboxes();
}


// ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
function createProjectSheets() {
LIB.createProjectSheets();
}


// ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åŒæœŸ
function syncTasksToCalendar() {
LIB.syncTasksToCalendar();
}


// çµ±åˆå®Ÿè¡Œ
function executeTasksAction() {
LIB.executeTasksAction();
}


// ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
function updateDashboardWithCalendarSync() {
LIB.updateDashboardWithCalendarSync();
}


// ==========================================
// 4. å®šæœŸå®Ÿè¡Œãƒˆãƒªã‚¬ãƒ¼ç”¨
// ==========================================


// ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -> ã‚·ãƒ¼ãƒˆ (15åˆ†ã”ã¨)
function syncFromCalendarToSheets() {
LIB.syncFromCalendarToSheets();
}


// ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–° (1æ™‚é–“ã”ã¨)
function updateDashboard() {
LIB.updateDashboard();
}
